


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > CLI</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">it.polimi.ingsw.view</a>
</div>

<h1>Coverage Summary for Class: CLI (it.polimi.ingsw.view)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">CLI</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/11)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/535)
  </span>
</td>
</tr>
  <tr>
    <td class="name">CLI$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/12)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/536)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package it.polimi.ingsw.view;
&nbsp;
&nbsp;import it.polimi.ingsw.enums.State;
&nbsp;import it.polimi.ingsw.model.Board;
&nbsp;import it.polimi.ingsw.network.messages.Message;
&nbsp;import it.polimi.ingsw.network.messages.SendDataToServer;
&nbsp;import it.polimi.ingsw.network.server.Server;
&nbsp;import it.polimi.ingsw.view.cliChat.ThreadRead;
&nbsp;import org.jetbrains.annotations.NotNull;
&nbsp;
&nbsp;import java.io.BufferedReader;
&nbsp;import java.io.FileReader;
&nbsp;import java.io.IOException;
&nbsp;import java.io.OutputStream;
&nbsp;import java.net.Socket;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.List;
&nbsp;import java.util.Scanner;
&nbsp;
&nbsp;import static it.polimi.ingsw.enums.State.*;
&nbsp;
&nbsp;/**
&nbsp; * The CLI class represents the Command-Line Interface (CLI) view in the application
&nbsp; * It extends the View class and provides methods for interacting with the user through the command line
&nbsp; */
&nbsp;public class CLI extends View {
&nbsp;    // Reset
&nbsp;    public static final String RESET = &quot;\033[0m&quot;;  // Text Reset
&nbsp;    // Regular Colors
&nbsp;    public static final String BLACK = &quot;\033[38;5;238m&quot;;   // BLACK
&nbsp;    public static final String RED = &quot;\033[38;5;196m&quot;;     // RED
&nbsp;    public static final String GREEN = &quot;\033[38;5;46m&quot;;   // GREEN
&nbsp;    public static final String YELLOW = &quot;\033[38;5;226m&quot;;  // YELLOW
&nbsp;    public static final String BLUE = &quot;\033[38;5;21m&quot;;    // BLUE
&nbsp;    public static final String PURPLE = &quot;\033[38;5;129m&quot;;  // PURPLE
&nbsp;    public static final String CYAN = &quot;\033[38;5;51m&quot;;    // CYAN
&nbsp;    public static final String WHITE = &quot;\033[38;5;231m&quot;;   // WHITE
<b class="nc">&nbsp;    int state = 20;</b>
<b class="nc">&nbsp;    Scanner terminal = new Scanner(System.in);</b>
<b class="nc">&nbsp;    private final Object lock = new Object();</b>
<b class="nc">&nbsp;    private volatile boolean isRunning = true;</b>
<b class="nc">&nbsp;    Message msg = null;</b>
&nbsp;    private String nickname;
&nbsp;    int networkProtocol;
<b class="nc">&nbsp;    StringBuilder playerList = new StringBuilder(&quot;â•¬&quot;);</b>
<b class="nc">&nbsp;    boolean chatOpen = false;</b>
<b class="nc">&nbsp;    boolean waiting = false;</b>
<b class="nc">&nbsp;    boolean alreadyDone = false;</b>
<b class="nc">&nbsp;    boolean end = false;</b>
<b class="nc">&nbsp;    boolean canNotPlay = false;</b>
<b class="nc">&nbsp;    Socket socket = null;</b>
<b class="nc">&nbsp;    List&lt;String&gt; otherShelf = new ArrayList&lt;&gt;();</b>
&nbsp;    ThreadRead userInput;
<b class="nc">&nbsp;    int yourNumber = 0;</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Constructs a new CLI view
&nbsp;     */
&nbsp;    public CLI() {
<b class="nc">&nbsp;        super();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Gets the nickname of the user
&nbsp;     *
&nbsp;     * @return the nickname
&nbsp;     */
&nbsp;    public String getNickname(){
<b class="nc">&nbsp;        return this.nickname;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Sets the network protocol
&nbsp;     *
&nbsp;     * @param networkClient the network protocol value
&nbsp;     */
&nbsp;    public void setNetwork(int networkClient) {
<b class="nc">&nbsp;        this.networkProtocol = networkClient;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * stops the thread
&nbsp;     */
&nbsp;    public void stop() {
<b class="nc">&nbsp;        isRunning = false;</b>
<b class="nc">&nbsp;        synchronized (lock) {</b>
<b class="nc">&nbsp;            lock.notifyAll();</b>
<b class="nc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * @see View#run()
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void run() {
<b class="nc">&nbsp;        System.out.println(&quot;\nCLI RUNNING CORRECTLY&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        System.out.println(YELLOW + &quot;\n&quot; + &quot;ooo        ooooo                   .oooooo..o oooo                  oooo   .o88o.  o8o              \n&quot; +</b>
&nbsp;                                           &quot;`88.       .888&#39;                  d8P&#39;    `Y8 `888                  `888   888 `\&quot;  `\&quot;&#39;            \n&quot; +
&nbsp;                                           &quot; 888b     d&#39;888  oooo    ooo      Y88bo.       888 .oo.    .ooooo.   888  o888oo  oooo   .ooooo.    \n&quot; +
&nbsp;                                           &quot; 8 Y88. .P  888   `88.  .8&#39;        `\&quot;Y8888o.   888P\&quot;Y88b  d88&#39; `88b  888   888    `888  d88&#39; `88b \n&quot; +
&nbsp;                                           &quot; 8  `888&#39;   888    `88..8&#39;             `\&quot;Y88b  888   888  888ooo888  888   888     888  888ooo888  \n&quot; +
&nbsp;                                           &quot; 8    Y     888     `888&#39;         oo     .d8P  888   888  888    .o  888   888     888  888    .o   \n&quot; +
&nbsp;                                           &quot;o8o        o888o     .8&#39;          8\&quot;\&quot;88888P&#39;  o888o o888o `Y8bod8P&#39; o888o o888o   o888o `Y8bod8P&#39; \n&quot; +
&nbsp;                                           &quot;                 .o..P&#39;                                                                             \n&quot; +
&nbsp;                                           &quot;                 `Y8P&#39;                                                                              \n&quot; + RESET);
&nbsp;
<b class="nc">&nbsp;        System.out.print(&quot;Please enter a nickname: &quot;);</b>
<b class="nc">&nbsp;        nickname = terminal.next();</b>
<b class="nc">&nbsp;        msg = new SendDataToServer(SET_NICKNAME, nickname, 0, 0, false);</b>
<b class="nc">&nbsp;        setChangedView();</b>
<b class="nc">&nbsp;        notifyObserversView(msg);</b>
&nbsp;
<b class="nc">&nbsp;        while (isRunning) {</b>
&nbsp;            //System.out.println(&quot;Stato: &quot; + state);
<b class="nc">&nbsp;            switch (state) {</b>
&nbsp;                case 0:
&nbsp;                    //Form to enter a new nickname because someone already have the one expressed before
<b class="nc">&nbsp;                    System.out.print(&quot;Someone has a nickname as the one you just wrote.\nPlease enter a different nickname: &quot;);</b>
<b class="nc">&nbsp;                    nickname = terminal.next();</b>
<b class="nc">&nbsp;                    msg = new SendDataToServer(SET_NICKNAME, nickname, 0, 0, false);</b>
<b class="nc">&nbsp;                    setChangedView();</b>
<b class="nc">&nbsp;                    notifyObserversView(msg);</b>
<b class="nc">&nbsp;                    msg = null;</b>
<b class="nc">&nbsp;                    if (networkProtocol == 1)</b>
<b class="nc">&nbsp;                        state = 20;</b>
&nbsp;                    break;
&nbsp;                case 1:
&nbsp;                    //All the players required are in game so no more are needed
<b class="nc">&nbsp;                    if (!end) {</b>
<b class="nc">&nbsp;                        System.out.println(&quot;No more players are required in this game, we are sorry, you will be disconnected&quot;);</b>
<b class="nc">&nbsp;                        chatOpen = true;</b>
<b class="nc">&nbsp;                        canNotPlay = true;</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        System.out.println(&quot;Game ended, gooda bye&quot;);</b>
&nbsp;                    }
<b class="nc">&nbsp;                    stop();</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case 2:
&nbsp;                    //Waiting for player and waiting
<b class="nc">&nbsp;                    synchronized (lock) {</b>
&nbsp;                        try {
<b class="nc">&nbsp;                            if (!waiting) {</b>
<b class="nc">&nbsp;                                System.out.print(&quot;\n\n ~ WAITING FOR PLAYERS ~ \n\n&quot;);</b>
<b class="nc">&nbsp;                                waiting = true;</b>
&nbsp;                            }
<b class="nc">&nbsp;                            lock.wait();        //possibile lock per tutti i giocatori -&gt; da inviare una richiesta al server se i due numeri sono uguali</b>
<b class="nc">&nbsp;                            msg = null;</b>
<b class="nc">&nbsp;                        } catch (InterruptedException e) {</b>
<b class="nc">&nbsp;                            throw new RuntimeException(e);</b>
<b class="nc">&nbsp;                        }</b>
<b class="nc">&nbsp;                    }</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case 3:
&nbsp;                    //Insert the number of player for the game 2 / 3 / 4
<b class="nc">&nbsp;                    int numberPlayers = 0;</b>
<b class="nc">&nbsp;                    boolean okNumber = false;</b>
<b class="nc">&nbsp;                    System.out.print(&quot;Insert the number of players for the game (2 / 3 / 4): &quot;);</b>
&nbsp;                    do {
&nbsp;                        try {
<b class="nc">&nbsp;                            numberPlayers = Integer.parseInt(terminal.next());</b>
<b class="nc">&nbsp;                            if (numberPlayers &lt; 2 || numberPlayers &gt; 4) throw new NumberFormatException();</b>
<b class="nc">&nbsp;                            okNumber = true;</b>
<b class="nc">&nbsp;                        } catch (NumberFormatException e) {</b>
<b class="nc">&nbsp;                            System.out.print(&quot;You entered an invalid character, please enter a number (2 / 3 / 4): &quot;);</b>
<b class="nc">&nbsp;                        }</b>
<b class="nc">&nbsp;                    } while (!okNumber);</b>
&nbsp;
<b class="nc">&nbsp;                    if(okNumber) {</b>
<b class="nc">&nbsp;                        msg = new SendDataToServer(SET_NUMPLAYERS, this.nickname, numberPlayers, 0, false);</b>
<b class="nc">&nbsp;                        setChangedView();</b>
<b class="nc">&nbsp;                        notifyObserversView(msg);</b>
<b class="nc">&nbsp;                        msg = null;</b>
<b class="nc">&nbsp;                        if (networkProtocol == 1)</b>
<b class="nc">&nbsp;                            state = 20;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case -1:
&nbsp;                    //Check if the game should begin
<b class="nc">&nbsp;                    msg = new SendDataToServer(GAME_READY, null, 0, 0, false);</b>
<b class="nc">&nbsp;                    setChangedView();</b>
<b class="nc">&nbsp;                    notifyObserversView(msg);</b>
<b class="nc">&nbsp;                    msg = null;</b>
<b class="nc">&nbsp;                    if (networkProtocol == 1)</b>
<b class="nc">&nbsp;                        state = 20;</b>
&nbsp;                    break;
&nbsp;                case 4:
&nbsp;                    //Selecting an items from board by typing its coordinated row first followed by the column
<b class="nc">&nbsp;                    int row = -1;</b>
<b class="nc">&nbsp;                    int column = -1;</b>
<b class="nc">&nbsp;                    System.out.println(&quot;\nEnter the coordinates of the item you wanna select: &quot;);</b>
<b class="nc">&nbsp;                    System.out.print(&quot;Row: &quot;);</b>
&nbsp;                    do {
&nbsp;                        try {
<b class="nc">&nbsp;                            row = Integer.parseInt(terminal.next());</b>
<b class="nc">&nbsp;                        } catch (NumberFormatException e) {</b>
<b class="nc">&nbsp;                            System.out.println(&quot;It is not a valid number!!&quot;);</b>
<b class="nc">&nbsp;                        }</b>
<b class="nc">&nbsp;                        if (row &lt; 0 || row &gt; 8)</b>
<b class="nc">&nbsp;                            System.out.print(&quot;Enter a valid number for row: &quot;);</b>
<b class="nc">&nbsp;                    } while (row &lt; 0 || row &gt; 8);</b>
&nbsp;
<b class="nc">&nbsp;                    System.out.print(&quot;Column: &quot;);</b>
&nbsp;                    do {
&nbsp;                        try {
<b class="nc">&nbsp;                            column = Integer.parseInt(terminal.next());</b>
<b class="nc">&nbsp;                        } catch (NumberFormatException e) {</b>
<b class="nc">&nbsp;                            System.out.println(&quot;It is not a valid number!!&quot;);</b>
<b class="nc">&nbsp;                        }</b>
<b class="nc">&nbsp;                        if (column &lt; 0 || column &gt; 8)</b>
<b class="nc">&nbsp;                            System.out.print(&quot;Enter a valid number for row: &quot;);</b>
<b class="nc">&nbsp;                    } while (column &lt; 0 || column &gt; 8);</b>
<b class="nc">&nbsp;                    msg = new SendDataToServer(SELECT_ITEM, null, row, column, false);</b>
<b class="nc">&nbsp;                    setChangedView();</b>
<b class="nc">&nbsp;                    notifyObserversView(msg);</b>
<b class="nc">&nbsp;                    msg = null;</b>
<b class="nc">&nbsp;                    if (networkProtocol == 1)</b>
<b class="nc">&nbsp;                        state = 20;</b>
&nbsp;                    break;
&nbsp;
&nbsp;                case 5:
&nbsp;                    //Y = confirm the item selected from the board and then go to the insertion phase
<b class="nc">&nbsp;                    msg = new SendDataToServer(CONFIRM_ITEMS, null, 0, 0, true);</b>
<b class="nc">&nbsp;                    setChangedView();</b>
<b class="nc">&nbsp;                    notifyObserversView(msg);</b>
<b class="nc">&nbsp;                    msg = null;</b>
<b class="nc">&nbsp;                    if (networkProtocol == 1)</b>
<b class="nc">&nbsp;                        state = 20;</b>
&nbsp;                    break;
&nbsp;
&nbsp;                case 6:
<b class="nc">&nbsp;                    String orderOrColumn = terminal.next();</b>
<b class="nc">&nbsp;                    if (orderOrColumn.equals(&quot;C&quot;) || orderOrColumn.equals(&quot;c&quot;)) {</b>
<b class="nc">&nbsp;                        System.out.println(&quot;Type the number of one of the columns in the shelf highlighted with an arrow.&quot;);</b>
<b class="nc">&nbsp;                        boolean okColumn = false;</b>
<b class="nc">&nbsp;                        int columnShelf = 0;</b>
&nbsp;                        do {
&nbsp;                            try {
<b class="nc">&nbsp;                                columnShelf = Integer.parseInt(terminal.next());</b>
<b class="nc">&nbsp;                                okColumn = true;</b>
<b class="nc">&nbsp;                            } catch (NumberFormatException e) {</b>
<b class="nc">&nbsp;                                System.out.println(&quot;Please try again with a valid number: &quot;);</b>
<b class="nc">&nbsp;                            }</b>
<b class="nc">&nbsp;                        } while (!okColumn);</b>
<b class="nc">&nbsp;                        msg = new SendDataToServer(SELECT_COLUMN, null, 0, columnShelf, false);</b>
<b class="nc">&nbsp;                    } else {</b>
<b class="nc">&nbsp;                        System.out.println(&quot;Now you must order the items in the UNORDERED LIST, to do so you select the list and the item you wanna order&quot;);</b>
<b class="nc">&nbsp;                        System.out.println(&quot;Type 1 for the UNORDERED LIST or type 0 for the ORDERED.&quot;);</b>
<b class="nc">&nbsp;                        System.out.print(&quot;From the list (0 / 1): &quot;);</b>
<b class="nc">&nbsp;                        int action = -1;</b>
&nbsp;                        do {
&nbsp;                            try {
<b class="nc">&nbsp;                                action = Integer.parseInt(terminal.next());</b>
<b class="nc">&nbsp;                            } catch (NumberFormatException e) {</b>
<b class="nc">&nbsp;                                System.out.println(&quot;It is not a valid number!!&quot;);</b>
<b class="nc">&nbsp;                            }</b>
<b class="nc">&nbsp;                            if (action != 0 &amp;&amp; action != 1)</b>
<b class="nc">&nbsp;                                System.out.print(&quot;Enter 0 for ORDERED or 1 for UNORDERED: &quot;);</b>
<b class="nc">&nbsp;                        } while (action != 0 &amp;&amp; action != 1);</b>
<b class="nc">&nbsp;                        System.out.print(&quot;Order the item in position (0 / 1 / 2): &quot;);</b>
<b class="nc">&nbsp;                        int pos = -1;</b>
&nbsp;                        do {
&nbsp;                            try {
<b class="nc">&nbsp;                                pos = Integer.parseInt(terminal.next());</b>
<b class="nc">&nbsp;                            } catch (NumberFormatException e) {</b>
<b class="nc">&nbsp;                                System.out.println(&quot;It is not a valid number!!&quot;);</b>
<b class="nc">&nbsp;                            }</b>
<b class="nc">&nbsp;                            if (pos != 0 &amp;&amp; pos != 1 &amp;&amp; pos != 2)</b>
<b class="nc">&nbsp;                                System.out.print(&quot;Enter 0 - first item, 1 - second item or 2 - third item: &quot;);</b>
<b class="nc">&nbsp;                        } while (pos != 0 &amp;&amp; pos != 1 &amp;&amp; pos != 2);</b>
<b class="nc">&nbsp;                        msg = new SendDataToServer(ORDER_ITEM, null, action, pos, false);</b>
&nbsp;                    }
<b class="nc">&nbsp;                    setChangedView();</b>
<b class="nc">&nbsp;                    notifyObserversView(msg);</b>
<b class="nc">&nbsp;                    msg = null;</b>
<b class="nc">&nbsp;                    if (networkProtocol == 1)</b>
<b class="nc">&nbsp;                        state = 20;</b>
&nbsp;                    break;
&nbsp;
&nbsp;                case 7:
&nbsp;                    //Confirm column and order
<b class="nc">&nbsp;                    msg = new SendDataToServer(CONFIRM_INSERTION, null, 0, 0, true);</b>
<b class="nc">&nbsp;                    setChangedView();</b>
<b class="nc">&nbsp;                    notifyObserversView(msg);</b>
<b class="nc">&nbsp;                    msg = null;</b>
<b class="nc">&nbsp;                    if (networkProtocol == 1)</b>
<b class="nc">&nbsp;                        state = 20;</b>
&nbsp;                    break;
&nbsp;
&nbsp;                case 20:
<b class="nc">&nbsp;                    synchronized (lock) {</b>
&nbsp;                        try {
<b class="nc">&nbsp;                            lock.wait();</b>
<b class="nc">&nbsp;                            msg = null;</b>
<b class="nc">&nbsp;                        } catch (InterruptedException e) {</b>
<b class="nc">&nbsp;                            throw new RuntimeException(e);</b>
<b class="nc">&nbsp;                        }</b>
<b class="nc">&nbsp;                    }</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;
&nbsp;                default:
<b class="nc">&nbsp;                    System.out.println(&quot;Error&quot;);</b>
&nbsp;                    break;
&nbsp;            }
<b class="nc">&nbsp;            if (socket != null){</b>
<b class="nc">&nbsp;                userInput = new ThreadRead(this.socket, this);</b>
<b class="nc">&nbsp;                userInput.start();</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        System.exit(1);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * @see View#update(Server, Message)
&nbsp;     */
&nbsp;    public void update(Server o, @NotNull Message arg) {
<b class="nc">&nbsp;        synchronized (lock) {</b>
<b class="nc">&nbsp;            State msg = arg.getInfo();</b>
<b class="nc">&nbsp;            switch (msg) {</b>
&nbsp;                case RECONNECTED:
&nbsp;                case ACK_NICKNAME:
&nbsp;                case ACK_NUMPLAYERS:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    state = 2;</b>
<b class="nc">&nbsp;                    lock.notifyAll();</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;
&nbsp;                case SAME_NICKNAME:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    state = 0;</b>
<b class="nc">&nbsp;                    if(networkProtocol == 1)</b>
<b class="nc">&nbsp;                        lock.notifyAll();</b>
&nbsp;                    break;
&nbsp;
&nbsp;                case NOT_IN_PREV_GAME:
&nbsp;                case NACK_NICKNAME:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    state = 1;</b>
<b class="nc">&nbsp;                    if(networkProtocol == 1)</b>
<b class="nc">&nbsp;                        lock.notifyAll();</b>
&nbsp;                    break;
&nbsp;
&nbsp;                case NACK_NUMPLAYERS:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    if (arg.getNickname().equals(this.nickname)) {</b>
<b class="nc">&nbsp;                        System.out.println(&quot;Someone has already chosen the number of players, you will be added to that game&quot;);</b>
<b class="nc">&nbsp;                        state = -1;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    if(networkProtocol == 1)</b>
<b class="nc">&nbsp;                        lock.notifyAll();</b>
&nbsp;                    break;
&nbsp;
&nbsp;                case ASK_NUMPLAYERS:
&nbsp;                case OUT_BOUND_NUMPLAYERS:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    if (msg == OUT_BOUND_NUMPLAYERS &amp;&amp; arg.getNickname().equals(this.nickname))</b>
<b class="nc">&nbsp;                        System.out.println(&quot;Enter a valid number of player!!&quot;);</b>
<b class="nc">&nbsp;                    state = 3;</b>
<b class="nc">&nbsp;                    lock.notifyAll();</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;
&nbsp;                case GAME_READY:
&nbsp;                case IN_GAME:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    if(nickname.equals(arg.getNickname())){</b>
<b class="nc">&nbsp;                        System.out.println(RED + &quot;\nThis is the board: &quot; + RESET);</b>
<b class="nc">&nbsp;                        showBoard(arg.getBoard());</b>
<b class="nc">&nbsp;                        System.out.print(RED + &quot;\nThis is the first common goal: &quot; + RESET);</b>
<b class="nc">&nbsp;                        String[] splitGoal = arg.getFirstCommon().split(&quot;\n&quot;);</b>
<b class="nc">&nbsp;                        writeCommon(splitGoal[0]);</b>
<b class="nc">&nbsp;                        System.out.println(splitGoal[1]);</b>
<b class="nc">&nbsp;                        System.out.print(RED + &quot;\nThis is the second common goal: &quot; + RESET);</b>
<b class="nc">&nbsp;                        splitGoal = arg.getSecondCommon().split(&quot;\n&quot;);</b>
<b class="nc">&nbsp;                        writeCommon(splitGoal[0]);</b>
<b class="nc">&nbsp;                        System.out.println(splitGoal[1]);</b>
<b class="nc">&nbsp;                        System.out.println(RED + &quot;\nYour shelf:             Your personal goal: &quot; + RESET);</b>
<b class="nc">&nbsp;                        showPersonalAndShelf(arg.getPersonal(), arg.getShelf());</b>
&nbsp;
<b class="nc">&nbsp;                        if(msg == IN_GAME){</b>
<b class="nc">&nbsp;                            System.out.println();</b>
<b class="nc">&nbsp;                            for(int i = 0; i*2 &lt; otherShelf.size(); i++) {</b>
<b class="nc">&nbsp;                                System.out.print(RED + otherShelf.get(i * 2) + &quot;&#39;s shelf: &quot; + RESET);</b>
<b class="nc">&nbsp;                                for(int j = 0; j &lt; 15-otherShelf.get(i*2).length(); j++)</b>
<b class="nc">&nbsp;                                    System.out.print(&quot; &quot;);</b>
&nbsp;                            }
<b class="nc">&nbsp;                            System.out.println();</b>
<b class="nc">&nbsp;                            showOtherShelf(otherShelf);</b>
<b class="nc">&nbsp;                            otherShelf.clear();</b>
&nbsp;                        }
&nbsp;
<b class="nc">&nbsp;                        if(!chatOpen){</b>
<b class="nc">&nbsp;                            String os = System.getProperty(&quot;os.name&quot;).toLowerCase();</b>
&nbsp;
&nbsp;                            String command;
&nbsp;
<b class="nc">&nbsp;                            if (os.contains(&quot;win&quot;)) {</b>
&nbsp;                                //On Windows
<b class="nc">&nbsp;                                command = &quot;cmd /c start java -jar TerminalServer.jar&quot;;</b>
<b class="nc">&nbsp;                            } else if (os.contains(&quot;nix&quot;) || os.contains(&quot;nux&quot;)) {</b>
&nbsp;                                //On Linux
&nbsp;                                //command = &quot;x-terminal-emulator -e java -jar ./TerminalServer.jar&quot;;
<b class="nc">&nbsp;                                command = &quot;x-terminal-emulator -e java -jar /home/tommi/Scrivania/IngSW_Tommi/MyShelfie/TerminalServer.jar&quot;;</b>
&nbsp;
<b class="nc">&nbsp;                            } else if (os.contains(&quot;mac&quot;)) {</b>
&nbsp;                                //On macOS
<b class="nc">&nbsp;                                command = &quot;open -a Terminal.app java -jar ./TerminalServer.jar&quot;;</b>
&nbsp;                            } else {
&nbsp;                                //Error
<b class="nc">&nbsp;                                throw new UnsupportedOperationException(&quot;Sistema operativo non supportato&quot;);</b>
&nbsp;                            }
&nbsp;
&nbsp;                            try {
<b class="nc">&nbsp;                                Process process = Runtime.getRuntime().exec(command);</b>
<b class="nc">&nbsp;                            } catch (IOException e) {</b>
<b class="nc">&nbsp;                                throw new RuntimeException(e);</b>
<b class="nc">&nbsp;                            }</b>
&nbsp;
&nbsp;                            try {
<b class="nc">&nbsp;                                Thread.sleep(2000);</b>
<b class="nc">&nbsp;                            } catch (InterruptedException e) {</b>
<b class="nc">&nbsp;                                throw new RuntimeException(e);</b>
<b class="nc">&nbsp;                            }</b>
&nbsp;                        }
&nbsp;                    }
<b class="nc">&nbsp;                    if(networkProtocol == 1)</b>
<b class="nc">&nbsp;                        lock.notifyAll();</b>
&nbsp;                    break;
&nbsp;
&nbsp;                case PLAYER_LIST:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    int j = 1;</b>
<b class="nc">&nbsp;                    for(int i = 1; i &lt; 5; i++){</b>
<b class="nc">&nbsp;                        switch(i) {</b>
&nbsp;                            case 1:
<b class="nc">&nbsp;                                if (arg.getNickname() != null &amp;&amp; !arg.getNickname().equals(nickname)){</b>
<b class="nc">&nbsp;                                    playerList.append(j).append(&quot; - &quot;).append(arg.getNickname()).append(&quot; - &quot;);</b>
<b class="nc">&nbsp;                                    j++;</b>
&nbsp;                                }
<b class="nc">&nbsp;                                if(arg.getNickname() != null &amp;&amp; arg.getNickname().equals(nickname))</b>
<b class="nc">&nbsp;                                    this.yourNumber = i;</b>
&nbsp;                                break;
&nbsp;
&nbsp;                            case 2:
<b class="nc">&nbsp;                                if(arg.getBoard() != null &amp;&amp; !arg.getBoard().equals(nickname)){</b>
<b class="nc">&nbsp;                                    playerList.append(j).append(&quot; - &quot;).append(arg.getBoard()).append(&quot; - &quot;);</b>
<b class="nc">&nbsp;                                    j++;</b>
&nbsp;                                }
<b class="nc">&nbsp;                                if(arg.getBoard() != null &amp;&amp; arg.getBoard().equals(nickname))</b>
<b class="nc">&nbsp;                                    this.yourNumber = i;</b>
&nbsp;                                break;
&nbsp;
&nbsp;                            case 3:
<b class="nc">&nbsp;                                if(arg.getPersonal() != null &amp;&amp; !arg.getPersonal().equals(nickname)){</b>
<b class="nc">&nbsp;                                    playerList.append(j).append(&quot; - &quot;).append(arg.getPersonal()).append(&quot; - &quot;);</b>
<b class="nc">&nbsp;                                    j++;</b>
&nbsp;                                }
<b class="nc">&nbsp;                                if(arg.getPersonal() != null &amp;&amp; arg.getPersonal().equals(nickname))</b>
<b class="nc">&nbsp;                                    this.yourNumber = i;</b>
&nbsp;                                break;
&nbsp;                            case 4:
<b class="nc">&nbsp;                                if(arg.getShelf() != null &amp;&amp; !arg.getShelf().equals(nickname)){</b>
<b class="nc">&nbsp;                                    playerList.append(j).append(&quot; - &quot;).append(arg.getShelf()).append(&quot; - &quot;);</b>
<b class="nc">&nbsp;                                    j++;</b>
&nbsp;                                }
<b class="nc">&nbsp;                                if(arg.getShelf() != null &amp;&amp; arg.getShelf().equals(nickname))</b>
<b class="nc">&nbsp;                                    this.yourNumber = i;</b>
&nbsp;                                break;
&nbsp;
&nbsp;                            default:
<b class="nc">&nbsp;                                System.out.println(RED + &quot;Error&quot; + RESET);</b>
&nbsp;                                break;
&nbsp;                        }
&nbsp;                    }
<b class="nc">&nbsp;                    playerList.append(&quot;\n&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;
&nbsp;                case SEND_MODEL:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    if(!chatOpen) {</b>
&nbsp;                        try {
<b class="nc">&nbsp;                            int port = -1;</b>
&nbsp;
<b class="nc">&nbsp;                            if(networkProtocol == 1) {</b>
<b class="nc">&nbsp;                                int timeGUI = 8000*yourNumber;</b>
<b class="nc">&nbsp;                                Thread.sleep(timeGUI);</b>
<b class="nc">&nbsp;                            } else {</b>
<b class="nc">&nbsp;                                int timeCLI = 2000 * yourNumber;</b>
<b class="nc">&nbsp;                                Thread.sleep(timeCLI);</b>
&nbsp;                            }
&nbsp;
&nbsp;                            /*int timeCLI = 2000 * yourNumber;
&nbsp;                            Thread.sleep(timeCLI);*/
&nbsp;
<b class="nc">&nbsp;                            try (BufferedReader reader = new BufferedReader(new FileReader(&quot;port.txt&quot;))) {</b>
&nbsp;                                String line;
&nbsp;
&nbsp;                                do {
<b class="nc">&nbsp;                                    line = reader.readLine();</b>
<b class="nc">&nbsp;                                } while (line != null &amp;&amp; line.equals(&quot;-&quot;));</b>
&nbsp;
<b class="nc">&nbsp;                                if(line != null)</b>
<b class="nc">&nbsp;                                    port = Integer.parseInt(line);</b>
<b class="nc">&nbsp;                            } catch (IOException e) {</b>
<b class="nc">&nbsp;                                e.printStackTrace();</b>
<b class="nc">&nbsp;                            }</b>
&nbsp;
&nbsp;                            //Thread.sleep(2000);
&nbsp;
<b class="nc">&nbsp;                            System.out.print(RED + &quot;\nConnected to server chat at port: &quot; + port + RESET);</b>
<b class="nc">&nbsp;                            this.socket = new Socket(&quot;localhost&quot;, port);</b>
<b class="nc">&nbsp;                            String players = playerList.toString();                                          //Send the list of players to the chat, so it can show it</b>
&nbsp;
&nbsp;                            //Thread.sleep(2000);
&nbsp;
<b class="nc">&nbsp;                            socket.getOutputStream().write(players.getBytes());</b>
<b class="nc">&nbsp;                            socket.getOutputStream().flush();</b>
&nbsp;
<b class="nc">&nbsp;                            userInput = new ThreadRead(this.socket, this);</b>
<b class="nc">&nbsp;                            userInput.start();</b>
&nbsp;
<b class="nc">&nbsp;                            chatOpen = true;</b>
<b class="nc">&nbsp;                        } catch (IOException e) {</b>
<b class="nc">&nbsp;                            e.printStackTrace();</b>
<b class="nc">&nbsp;                        } catch (InterruptedException e) {</b>
<b class="nc">&nbsp;                            throw new RuntimeException(e);</b>
<b class="nc">&nbsp;                        }</b>
&nbsp;                    }
<b class="nc">&nbsp;                    if(!canNotPlay) {</b>
<b class="nc">&nbsp;                        if (!nickname.equals(arg.getNickname()) &amp;&amp; !alreadyDone) {</b>
<b class="nc">&nbsp;                            System.out.println(&quot;\n\nIt is &quot; + arg.getNickname() + &quot;&#39;s turn, let&#39;s wait for your turn!!&quot;);</b>
<b class="nc">&nbsp;                            state = 20;</b>
<b class="nc">&nbsp;                            alreadyDone = true;</b>
<b class="nc">&nbsp;                        } else if (nickname.equals(arg.getNickname()) &amp;&amp; !alreadyDone) {</b>
<b class="nc">&nbsp;                            System.out.println(&quot;\n\nIt is your turn &quot; + arg.getNickname() + &quot;!!&quot;);</b>
<b class="nc">&nbsp;                            System.out.println(&quot;To select a tile you must enter the couple Row - Column, if you wanna deselect it you can do it during the next submission by typing the same couple Row - Column.&quot;);</b>
<b class="nc">&nbsp;                            System.out.println(&quot;Each time you choose a tile press enter key to submit.&quot;);</b>
<b class="nc">&nbsp;                            state = 4;</b>
<b class="nc">&nbsp;                            alreadyDone = true;</b>
&nbsp;                        }
<b class="nc">&nbsp;                        lock.notifyAll();</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;
&nbsp;                case SELECTED:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    if (arg.getNickname().equals(this.nickname)) {</b>
<b class="nc">&nbsp;                        System.out.println(RED + &quot;\nIn the board, if you chose a valid item, it is highlight in red&quot; + RESET);</b>
<b class="nc">&nbsp;                        showBoard(arg.getBoard());</b>
<b class="nc">&nbsp;                        System.out.print(RED + &quot;\nHere you can see what you chose till now: &quot; + RESET);</b>
<b class="nc">&nbsp;                        showItems(arg.getSelected());</b>
<b class="nc">&nbsp;                        if (arg.getConfirm()) {</b>
<b class="nc">&nbsp;                            System.out.println(&quot;\nIf you wanna confirm you selection enter \&quot;YES\&quot; otherwise \&quot;NO\&quot;: -- (default \&quot;NO\&quot;)&quot;);</b>
<b class="nc">&nbsp;                            String confirmation = terminal.next();</b>
<b class="nc">&nbsp;                            if (confirmation.equals(&quot;Y&quot;) || confirmation.equals(&quot;y&quot;) || confirmation.equals(&quot;yes&quot;) || confirmation.equals(&quot;YES&quot;) || confirmation.equals(&quot;Yes&quot;)){</b>
<b class="nc">&nbsp;                                state = 5;</b>
<b class="nc">&nbsp;                                if(networkProtocol == 1)</b>
<b class="nc">&nbsp;                                    lock.notifyAll();</b>
&nbsp;                                break;
&nbsp;                            }
&nbsp;                        }
<b class="nc">&nbsp;                        state = 4;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    lock.notifyAll();</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;
&nbsp;                case ORDER_n_COLUMN:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    if(!canNotPlay) {</b>
<b class="nc">&nbsp;                        System.out.print(RED + &quot;\nIt follows the current state of the board, it is without &quot;);</b>
<b class="nc">&nbsp;                        if (arg.getNickname().equals(this.nickname)) System.out.println(&quot;your choice&quot; + RESET);</b>
<b class="nc">&nbsp;                        else System.out.println(arg.getNickname() + &quot;&#39;s choice&quot; + RESET);</b>
<b class="nc">&nbsp;                        showBoard(arg.getBoard());</b>
<b class="nc">&nbsp;                        if (arg.getNickname().equals(this.nickname)) {</b>
<b class="nc">&nbsp;                            System.out.print(RED + &quot;\nYour shelf:             Your personal goal: \n &quot; + RESET);</b>
<b class="nc">&nbsp;                            for (int i = 0; i &lt; 5; i++) System.out.print(i + &quot; &quot;);</b>
<b class="nc">&nbsp;                            System.out.print(&quot;\n&quot;);</b>
<b class="nc">&nbsp;                            showPersonalAndShelf(arg.getPersonal(), arg.getShelf());</b>
<b class="nc">&nbsp;                            showItems(arg.getColumns());</b>
<b class="nc">&nbsp;                            System.out.print(RED + &quot;\nYou can put tiles only in the columns where there is a red arrow&quot; + RESET);</b>
&nbsp;
<b class="nc">&nbsp;                            System.out.print(RED + &quot;\n\nThese are the lists of items you selected:&quot; + RESET);</b>
<b class="nc">&nbsp;                            System.out.print(&quot;\n                   &quot;);</b>
<b class="nc">&nbsp;                            for (int i = 0; i &lt; 3; i++) System.out.print(i + &quot; &quot;);</b>
<b class="nc">&nbsp;                            System.out.print(RED + &quot;\nUNORDERED ITEMS:&quot; + RESET + &quot; 1&quot;);</b>
<b class="nc">&nbsp;                            showItems(arg.getSelected());</b>
<b class="nc">&nbsp;                            System.out.print(RED + &quot;\n  ORDERED ITEMS:&quot; + RESET + &quot; 0&quot;);</b>
<b class="nc">&nbsp;                            showItems(arg.getOrderedRanking());</b>
&nbsp;
<b class="nc">&nbsp;                            System.out.println(&quot;\n\nNow you must select a column in the shelf and order the tile that will be inserted in it.&quot;);</b>
<b class="nc">&nbsp;                            System.out.println(&quot;Type \&quot;C\&quot; for choosing the column or type \&quot;O\&quot; for ordering the tiles: -- (default \&quot;O\&quot;)&quot;);</b>
<b class="nc">&nbsp;                            state = 6;</b>
&nbsp;                        }
<b class="nc">&nbsp;                        if (networkProtocol == 1)</b>
<b class="nc">&nbsp;                            lock.notifyAll();</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;
&nbsp;                case ACK_ORDER_n_COLUMN:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    if (arg.getNickname().equals(nickname)) {</b>
<b class="nc">&nbsp;                        System.out.print(RED + &quot;\nYour shelf:             Your personal goal: \n &quot; + RESET);</b>
<b class="nc">&nbsp;                        for (int i = 0; i &lt; 5; i++) System.out.print(i + &quot; &quot;);</b>
<b class="nc">&nbsp;                        System.out.print(&quot;\n&quot;);</b>
<b class="nc">&nbsp;                        showPersonalAndShelf(arg.getPersonal(), arg.getShelf());</b>
<b class="nc">&nbsp;                        showItems(arg.getColumns());</b>
<b class="nc">&nbsp;                        System.out.print(RED + &quot;\nYou can put tiles only in the columns where there is a red arrow&quot; + RESET);</b>
&nbsp;
<b class="nc">&nbsp;                        System.out.print(RED + &quot;\n\nThese are the lists of items you selected:&quot; + RESET);</b>
<b class="nc">&nbsp;                        System.out.print(&quot;\n                   &quot;);</b>
<b class="nc">&nbsp;                        for (int i = 0; i &lt; 3; i++) System.out.print(i + &quot; &quot;);</b>
<b class="nc">&nbsp;                        System.out.print(RED + &quot;\nUNORDERED ITEMS:&quot; + RESET + &quot; 1&quot;);</b>
<b class="nc">&nbsp;                        showItems(arg.getSelected());</b>
<b class="nc">&nbsp;                        System.out.print(RED + &quot;\n  ORDERED ITEMS:&quot; + RESET + &quot; 0&quot;);</b>
<b class="nc">&nbsp;                        showItems(arg.getOrderedRanking());</b>
<b class="nc">&nbsp;                        if (arg.getConfirm()) {</b>
<b class="nc">&nbsp;                            System.out.println(&quot;\nIf you wanna confirm you selection enter \&quot;YES\&quot; otherwise \&quot;NO\&quot;: -- (default \&quot;NO\&quot;)&quot;);</b>
<b class="nc">&nbsp;                            String insert = terminal.next();</b>
<b class="nc">&nbsp;                            if (insert.equals(&quot;Y&quot;) || insert.equals(&quot;y&quot;) || insert.equals(&quot;yes&quot;) || insert.equals(&quot;YES&quot;) || insert.equals(&quot;Yes&quot;)){</b>
<b class="nc">&nbsp;                                state = 7;</b>
<b class="nc">&nbsp;                                if(networkProtocol == 1)</b>
<b class="nc">&nbsp;                                    lock.notifyAll();</b>
&nbsp;                                break;
&nbsp;                            }
&nbsp;                        }
<b class="nc">&nbsp;                        System.out.println(&quot;\nType \&quot;C\&quot; for choosing the column or type \&quot;O\&quot; for ordering the tiles: -- (default \&quot;O\&quot;)&quot;);</b>
<b class="nc">&nbsp;                        state = 6;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    if(networkProtocol == 1)</b>
<b class="nc">&nbsp;                        lock.notifyAll();</b>
&nbsp;                    break;
&nbsp;
&nbsp;                case NACK_COLUMN:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    if (arg.getNickname().equals(nickname)) {</b>
<b class="nc">&nbsp;                        System.out.println(&quot;\nPlease enter a valid column number!&quot;);</b>
<b class="nc">&nbsp;                        System.out.println(&quot;\nFor changing column type \&quot;C\&quot; -- For ordering items type \&quot;O\&quot;: &quot;);</b>
<b class="nc">&nbsp;                        state = 6;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    if(networkProtocol == 1)</b>
<b class="nc">&nbsp;                        lock.notifyAll();</b>
&nbsp;                    break;
&nbsp;
&nbsp;                case NACK_ORDER:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    if (arg.getNickname().equals(nickname)) {</b>
<b class="nc">&nbsp;                        System.out.println(&quot;\nPlease enter a valid item number or select a non empty list!&quot;);</b>
<b class="nc">&nbsp;                        System.out.println(&quot;\nFor changing column type \&quot;C\&quot; -- For ordering items type \&quot;O\&quot;: &quot;);</b>
<b class="nc">&nbsp;                        state = 6;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    if(networkProtocol == 1)</b>
<b class="nc">&nbsp;                        lock.notifyAll();</b>
&nbsp;                    break;
&nbsp;
&nbsp;                case INSERTION_DONE:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    if (arg.getNickname().equals(nickname)) {</b>
<b class="nc">&nbsp;                        System.out.println(&quot;\nYour shelf now is:&quot;);</b>
<b class="nc">&nbsp;                        showItems(arg.getShelf());</b>
<b class="nc">&nbsp;                        System.out.println(&quot;\n\nYour turn is now finished!!&quot;);</b>
&nbsp;                    }
<b class="nc">&nbsp;                    state = 20;</b>
<b class="nc">&nbsp;                    if(networkProtocol == 1)</b>
<b class="nc">&nbsp;                        lock.notifyAll();</b>
&nbsp;                    break;
&nbsp;
&nbsp;                case SEND_OTHER_SHELF:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    if(!arg.getNickname().equals(nickname)){</b>
<b class="nc">&nbsp;                        otherShelf.add(arg.getNickname());</b>
<b class="nc">&nbsp;                        otherShelf.add(arg.getShelf());</b>
<b class="nc">&nbsp;                        alreadyDone = false;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;
&nbsp;                case FIRSTCOMMONGOAL_TAKEN:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    if (arg.getNickname().equals(this.nickname)) {</b>
<b class="nc">&nbsp;                        System.out.print(RED + &quot;\nYou&quot;);</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        System.out.print(RED + &quot;\n&quot; + arg.getNickname());</b>
&nbsp;                    }
<b class="nc">&nbsp;                    System.out.println(&quot;obtained: &quot; + arg.getFirstCommon() + &quot; points from the first common goal&quot; + RESET);</b>
<b class="nc">&nbsp;                    if(networkProtocol == 1)</b>
<b class="nc">&nbsp;                        lock.notifyAll();</b>
&nbsp;                    break;
&nbsp;
&nbsp;                case SECONDCOMMONGOAL_TAKEN:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    if (arg.getNickname().equals(this.nickname)) {</b>
<b class="nc">&nbsp;                        System.out.print(RED + &quot;\nYou&quot;);</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        System.out.print(RED + &quot;\n&quot; + arg.getNickname());</b>
&nbsp;                    }
<b class="nc">&nbsp;                    System.out.println(&quot; obtained: &quot; + arg.getSecondCommon() + &quot; points from the second common goal&quot; + RESET);</b>
<b class="nc">&nbsp;                    if(networkProtocol == 1)</b>
<b class="nc">&nbsp;                        lock.notifyAll();</b>
&nbsp;                    break;
&nbsp;
&nbsp;                case TOKEN_END_GAME:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    if (arg.getNickname().equals(this.nickname)) {</b>
<b class="nc">&nbsp;                        System.out.print(RED + &quot;\nYou&quot;);</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        System.out.print(RED + &quot;\n&quot; + arg.getNickname());</b>
&nbsp;                    }
<b class="nc">&nbsp;                    System.out.println(&quot;completed Shelf and obtained endGame&#39;s point!&quot; + RESET);</b>
<b class="nc">&nbsp;                    if(networkProtocol == 1)</b>
<b class="nc">&nbsp;                        lock.notifyAll();</b>
&nbsp;                    break;
&nbsp;
&nbsp;                case RESULTS:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    System.out.println(RED + arg.getOrderedRanking() + RESET);</b>
<b class="nc">&nbsp;                    end = true;</b>
<b class="nc">&nbsp;                    state = 1;</b>
<b class="nc">&nbsp;                    lock.notifyAll();</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;
&nbsp;                case CHAT_MESSAGE:
&nbsp;                    //arg.printMsg();
&nbsp;                    try {
<b class="nc">&nbsp;                        OutputStream outputStream = socket.getOutputStream();</b>
<b class="nc">&nbsp;                        StringBuilder message = new StringBuilder(&quot;&quot;);</b>
&nbsp;                        String chatMsg;
<b class="nc">&nbsp;                        if(!arg.getFrom().equals(nickname)) {</b>
<b class="nc">&nbsp;                            if (arg.getTo() != null &amp;&amp; arg.getTo().equals(nickname))</b>
<b class="nc">&nbsp;                                message.append(&quot;P-&quot;).append(arg.getFrom()).append(&quot;-&quot;).append(arg.getText()).append(&quot;-P&quot;);</b>
<b class="nc">&nbsp;                            else if(arg.getTo() == null)</b>
<b class="nc">&nbsp;                                message.append(&quot;A-&quot;).append(arg.getFrom()).append(&quot;-&quot;).append(arg.getText()).append(&quot;-A&quot;);</b>
&nbsp;                            else
<b class="nc">&nbsp;                                break;</b>
<b class="nc">&nbsp;                            chatMsg = message.toString();</b>
<b class="nc">&nbsp;                            outputStream.write((chatMsg + &quot;\n&quot;).getBytes());</b>
<b class="nc">&nbsp;                            outputStream.flush();</b>
&nbsp;                        }
<b class="nc">&nbsp;                    } catch (IOException e) {</b>
<b class="nc">&nbsp;                        throw new RuntimeException(e);</b>
<b class="nc">&nbsp;                    }</b>
&nbsp;                    break;
&nbsp;
&nbsp;                case TOKENS_TAKEN:
&nbsp;                case PING:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    break;</b>
&nbsp;
&nbsp;                case TOO_MANY:
&nbsp;                    //arg.printMsg();
<b class="nc">&nbsp;                    System.out.println(&quot;\n\n Too many players are trying to access this game, you will be disconnected \n\n&quot;);</b>
<b class="nc">&nbsp;                    System.exit(1);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;
&nbsp;                default:
<b class="nc">&nbsp;                    System.err.println(&quot;Ignoring event from &quot; + msg + &quot;: &quot; + arg);</b>
&nbsp;                    break;
&nbsp;            }
<b class="nc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Renders correctly the board
&nbsp;     *
&nbsp;     * @param board the encoded board
&nbsp;     * @see Board#toString()
&nbsp;     */
&nbsp;    private void showBoard(String board) {
<b class="nc">&nbsp;        System.out.print(&quot;  &quot;);</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; 9; i++) System.out.print(i + &quot;  &quot;);</b>
<b class="nc">&nbsp;        System.out.print(&quot;\n&quot;);</b>
<b class="nc">&nbsp;        int i = 0;</b>
<b class="nc">&nbsp;        for (int j = 0; j &lt; board.length(); j++) {</b>
<b class="nc">&nbsp;            if (j == i * 29 &amp;&amp; i != 9) {</b>
<b class="nc">&nbsp;                System.out.print(i);</b>
<b class="nc">&nbsp;                i++;</b>
&nbsp;            }
<b class="nc">&nbsp;            switch (board.charAt(j)) {</b>
&nbsp;                case &#39;W&#39;:
<b class="nc">&nbsp;                    System.out.print(WHITE + &#39;â– &#39; + RESET);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case &#39;G&#39;:
<b class="nc">&nbsp;                    System.out.print(GREEN + &#39;â– &#39; + RESET);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case &#39;B&#39;:
<b class="nc">&nbsp;                    System.out.print(BLUE + &#39;â– &#39; + RESET);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case &#39;Y&#39;:
<b class="nc">&nbsp;                    System.out.print(YELLOW + &#39;â– &#39; + RESET);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case &#39;P&#39;:
<b class="nc">&nbsp;                    System.out.print(PURPLE + &#39;â– &#39; + RESET);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case &#39;L&#39;:
<b class="nc">&nbsp;                    System.out.print(CYAN + &#39;â– &#39; + RESET);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case &#39;#&#39;:
<b class="nc">&nbsp;                    System.out.print(RED + &#39;â– &#39; + RESET);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case &#39;0&#39;:
&nbsp;                case &#39;2&#39;:
&nbsp;                case &#39;1&#39;:
<b class="nc">&nbsp;                    System.out.print(&quot; &quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                default:
<b class="nc">&nbsp;                    System.out.print(BLACK + board.charAt(j) + RESET);</b>
&nbsp;                    break;
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Displays the other players&#39; shelves
&nbsp;     *
&nbsp;     * @param otherShelf the list of strings representing the other players&#39; shelves
&nbsp;     */
&nbsp;    private void showOtherShelf(List&lt;String&gt; otherShelf){
<b class="nc">&nbsp;        int numShelf = otherShelf.size() / 2;</b>
<b class="nc">&nbsp;        switch(numShelf){</b>
&nbsp;            case 1:
<b class="nc">&nbsp;                showItems(otherShelf.get(1));</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;
&nbsp;            case 2:
<b class="nc">&nbsp;                for(int i = 0; i &lt; otherShelf.get(1).length(); i++){</b>
<b class="nc">&nbsp;                    if(i == 6)</b>
<b class="nc">&nbsp;                        break;</b>
<b class="nc">&nbsp;                    showItems(otherShelf.get(1).split(&quot;\n&quot;)[i]);</b>
<b class="nc">&nbsp;                    System.out.print(&quot;             &quot;);</b>
<b class="nc">&nbsp;                    showItems(otherShelf.get(3).split(&quot;\n&quot;)[i]);</b>
<b class="nc">&nbsp;                    System.out.print(&quot;\n&quot;);</b>
&nbsp;                }
<b class="nc">&nbsp;                break;</b>
&nbsp;
&nbsp;            case 3:
<b class="nc">&nbsp;                for(int i = 0; i &lt; otherShelf.get(1).length(); i++){</b>
<b class="nc">&nbsp;                    if(i == 6)</b>
<b class="nc">&nbsp;                        break;</b>
<b class="nc">&nbsp;                    showItems(otherShelf.get(1).split(&quot;\n&quot;)[i]);</b>
<b class="nc">&nbsp;                    System.out.print(&quot;             &quot;);</b>
<b class="nc">&nbsp;                    showItems(otherShelf.get(3).split(&quot;\n&quot;)[i]);</b>
<b class="nc">&nbsp;                    System.out.print(&quot;             &quot;);</b>
<b class="nc">&nbsp;                    showItems(otherShelf.get(5).split(&quot;\n&quot;)[i]);</b>
<b class="nc">&nbsp;                    System.out.print(&quot;\n&quot;);</b>
&nbsp;                }
<b class="nc">&nbsp;                break;</b>
&nbsp;
&nbsp;            default:
<b class="nc">&nbsp;                System.out.println(&quot;Error showing others shelf&quot;);</b>
&nbsp;                break;
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Writes a description of a common goal based on the provided goal identifier
&nbsp;     *
&nbsp;     * @param commonGoal the identifier of the common goal
&nbsp;     */
&nbsp;    private void writeCommon(String commonGoal){
&nbsp;        //System.out.println(commonGoal);
<b class="nc">&nbsp;        switch (commonGoal) {</b>
&nbsp;            case &quot;FIVEX&quot;:
<b class="nc">&nbsp;                System.out.println(&quot;Five tiles of the same type forming an X&quot;);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;
&nbsp;            case &quot;FOURANGLES&quot;:
<b class="nc">&nbsp;                System.out.println(&quot;Four tiles of the same type in the four corners of the bookshelf&quot;);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;
&nbsp;            case &quot;SIXCOUPLES&quot;:
<b class="nc">&nbsp;                System.out.println(&quot;Six groups each containing at least 2 tiles of the same type\n&quot; +</b>
&nbsp;                        &quot;                               The tiles of one group can be different from those of another group&quot;);
<b class="nc">&nbsp;                break;</b>
&nbsp;
&nbsp;            case &quot;FIVEDIAGONAL&quot;:
<b class="nc">&nbsp;                System.out.println(&quot;Five tiles of the same type forming a diagonal&quot;);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;
&nbsp;            case &quot;SQUARE2X2&quot;:
<b class="nc">&nbsp;                System.out.println(&quot;Two groups each containing 4 tiles of the same type in a 2x2 square\n&quot; +</b>
&nbsp;                        &quot;                               The tiles of one square has to be the same from those of the other square.&quot;);
<b class="nc">&nbsp;                break;</b>
&nbsp;
&nbsp;            case &quot;FOURADJACENT&quot;:
<b class="nc">&nbsp;                System.out.println(&quot;Four groups each containing at least 4 tiles of the same type\n&quot; +</b>
&nbsp;                        &quot;                               The tiles of one group can be different from those of another group.&quot;);
<b class="nc">&nbsp;                break;</b>
&nbsp;
&nbsp;            case &quot;EIGHTSAMETYPE&quot;:
<b class="nc">&nbsp;                System.out.println(&quot;Eight tiles of the same type&quot;);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;
&nbsp;            case &quot;FIVEDECRESING&quot;:
<b class="nc">&nbsp;                System.out.println(&quot;Five columns of increasing or decreasing height: starting with the first column to the left or right,\n&quot; +</b>
&nbsp;                        &quot;                               each subsequent column must consist of one more tile. Tiles can be of any type.&quot;);
<b class="nc">&nbsp;                break;</b>
&nbsp;
&nbsp;            case &quot;ROW4ITEMS5&quot;:
<b class="nc">&nbsp;                System.out.println(&quot;Four lines each formed by 5 tiles of maximum three different types.\n&quot; +</b>
&nbsp;                        &quot;                               One line can show the same or a different combination of another line&quot;);
<b class="nc">&nbsp;                break;</b>
&nbsp;
&nbsp;            case &quot;COLUMNS3ITEMS6&quot;:
<b class="nc">&nbsp;                System.out.println(&quot;Three columns each formed by 6 tiles of maximum three different types.\n&quot; +</b>
&nbsp;                        &quot;                               One column can show the same or a different combination of another column&quot;);
<b class="nc">&nbsp;                break;</b>
&nbsp;
&nbsp;            case &quot;ROW2ITEMS5DIFFERENT&quot;:
<b class="nc">&nbsp;                System.out.println(&quot;Two lines each formed by 5 different types of tiles.\n&quot; +</b>
&nbsp;                        &quot;                               One line can show the same or a different combination of the other line&quot;);
<b class="nc">&nbsp;                break;</b>
&nbsp;
&nbsp;            case &quot;COLUMNS2ITEMS6DIFFERENT&quot;:
<b class="nc">&nbsp;                System.out.println(&quot;Two columns each formed by 6 different types of tiles&quot;);</b>
&nbsp;                break;
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Displays the personal goals and the player&#39;s own shelf in a formatted manner
&nbsp;     *
&nbsp;     * @param personalGoals the string representing the personal goals
&nbsp;     * @param ownShelf the string representing the player&#39;s own shelf
&nbsp;     */
&nbsp;    private void showPersonalAndShelf(String personalGoals, String ownShelf){
<b class="nc">&nbsp;        String[] personal = personalGoals.split(&quot;\n&quot;);</b>
<b class="nc">&nbsp;        String[] shelf = ownShelf.split(&quot;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        for(int i = 0; i &lt; shelf.length; i++){</b>
<b class="nc">&nbsp;            showItems(shelf[i]);</b>
<b class="nc">&nbsp;            System.out.print(&quot;             &quot;);</b>
<b class="nc">&nbsp;            showItems(personal[i]);</b>
<b class="nc">&nbsp;            System.out.print(&quot;\n&quot;);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Displays the items in the specified format
&nbsp;     *
&nbsp;     * @param items the items to display
&nbsp;     */
&nbsp;    public void showItems(String items) {
<b class="nc">&nbsp;        boolean columnChoosen = false;</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; items.length(); i++) {</b>
<b class="nc">&nbsp;            if (items.charAt(i) == &#39;#&#39;) {</b>
<b class="nc">&nbsp;                columnChoosen = true;</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        for (int j = 0; j &lt; items.length(); j++) {</b>
<b class="nc">&nbsp;            if (columnChoosen) {</b>
<b class="nc">&nbsp;                if (items.charAt(j) == &#39;#&#39;) System.out.print(RED + &#39;â–²&#39; + RESET);</b>
<b class="nc">&nbsp;                else System.out.print(BLACK + items.charAt(j) + RESET);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                switch (items.charAt(j)) {</b>
&nbsp;                    case &#39;W&#39;:
<b class="nc">&nbsp;                        System.out.print(WHITE + &#39;â– &#39; + RESET);</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    case &#39;G&#39;:
<b class="nc">&nbsp;                        System.out.print(GREEN + &#39;â– &#39; + RESET);</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    case &#39;B&#39;:
<b class="nc">&nbsp;                        System.out.print(BLUE + &#39;â– &#39; + RESET);</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    case &#39;Y&#39;:
<b class="nc">&nbsp;                        System.out.print(YELLOW + &#39;â– &#39; + RESET);</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    case &#39;P&#39;:
<b class="nc">&nbsp;                        System.out.print(PURPLE + &#39;â– &#39; + RESET);</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    case &#39;L&#39;:
<b class="nc">&nbsp;                        System.out.print(CYAN + &#39;â– &#39; + RESET);</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    case &#39;â–²&#39;:
<b class="nc">&nbsp;                        System.out.print(RED + items.charAt(j) + RESET);</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    case &#39;0&#39;:
&nbsp;                    case &#39;1&#39;:
&nbsp;                    case &#39;2&#39;:
&nbsp;                    case &#39;3&#39;:
&nbsp;                    case &#39;4&#39;:
&nbsp;                    case &#39;5&#39;:
&nbsp;                    case &#39;6&#39;:
&nbsp;                    case &#39;7&#39;:
&nbsp;                    case &#39;8&#39;:
&nbsp;                    case &#39;9&#39;:
&nbsp;                    case &#39;~&#39;:
<b class="nc">&nbsp;                        System.out.print(&quot; &quot;);</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    default:
<b class="nc">&nbsp;                        System.out.print(BLACK + items.charAt(j) + RESET);</b>
&nbsp;                        break;
&nbsp;                }
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-06-29 17:12</div>
</div>
</body>
</html>
